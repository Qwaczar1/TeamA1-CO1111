<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="styles.css"> <!-- Link to external stylesheet -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- Responsive viewport settings -->
    <title>Unit Test - Treasure Hunts List</title>
</head>
<body>
    <!-- Header section -->
    <header id="header">
        <div id="headerContent">
            <div id="align">
                <div id="headerContainer1">
                    <img src="media/Banner2.png" id="greenHeaderLogo" alt="Treasure Hunt Logo">
                </div>
                <div id="headerContainer2">
                    <h4>Code Cyprus</h4>
                </div>
            </div>
            <nav id="nav">
                <ul id="navList">
                    <!-- Home button -->
                    <li class="navItem">
                        <a class="navLink" href="index.html">HOME</a>
                    </li>
                    <!-- Testing button -->
                    <li class="navItem">
                        <a href="test.html" class="navLink">TESTING</a>
                    </li>
                    <!-- Refresh button -->
                    <li class="navItem">
                        <a onclick="refresh()" class="navLink">REFRESH</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <div id="testRunDiv">
        <h2 id="testHeader">Unit Test - Treasure Hunts List</h2>
        <input type="number" step="1" id="numOfTreasureHuntsInput"/>
        <input class="testButtons" type="button" onclick="runTest()" value="Run Test"/>
        <input class="testButtons" type="button" onclick="runAutomatedTest()" value="Run Automated Test"/>
        <p id="testResults">Results are printed on the console.</p>
    </div>
    <script>
        let testValues = [-1, 0, 1, 2, 10, null, ""];

        let testResults = document.getElementById("testResults");

        async function runAutomatedTest(){
            for (let i = 0; i <testValues.length; i++) {
                // testResults.innerHTML = await getTreasureHunts(testValues[i]) + "<br>";
                console.log(await getTreasureHunts(testValues[i]));
            }
        }

        function runTest(){
            const numOfTreasureHuntsInput = document.getElementById("numOfTreasureHuntsInput");
            const numOfTreasureHunts = numOfTreasureHuntsInput.value;
            getTreasureHunts(numOfTreasureHunts).then(value => {
                console.log(value);
            })
        }


        async function getTreasureHunts(numOfTreasureHunts) {
            // Fetch treasure hunts data
            return await fetch(`https://codecyprus.org/th/test-api/list?number-of-ths=${numOfTreasureHunts}`)
                .then(response => response.json())
                .then(jsonObject => {
                    const status = jsonObject.status;
                    if (status === "OK") {
                        let treasureHunts = jsonObject.treasureHunts;
                        return treasureHunts.length;
                    }
                    else {
                        return false;
                    }
                });
        }
    </script>
</body>
</html>